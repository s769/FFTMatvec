\hypertarget{matvec_8hpp}{}\doxysection{/home/srvenkat/matvec-\/test/src/matvec.hpp File Reference}
\label{matvec_8hpp}\index{/home/srvenkat/matvec-\/test/src/matvec.hpp@{/home/srvenkat/matvec-\/test/src/matvec.hpp}}


Header file for the Matvec namespace.  


{\ttfamily \#include \char`\"{}shared.\+hpp\char`\"{}}\newline
{\ttfamily \#include \char`\"{}utils.\+hpp\char`\"{}}\newline
{\ttfamily \#include $<$cutranspose.\+h$>$}\newline
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{matvec_8hpp_aabe780dd505d3c74bda0cead3705d835}{Matvec\+::setup}} (Complex $\ast$$\ast$d\+\_\+mat\+\_\+freq, const double $\ast$const h\+\_\+mat, const unsigned int block\+\_\+size, const unsigned int num\+\_\+cols, const unsigned int num\+\_\+rows, cublas\+Handle\+\_\+t cublas\+Handle)
\begin{DoxyCompactList}\small\item\em Set up the matrix and perform necessary initialization. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{matvec_8hpp_a88ade5f11b1bb8dff52f6cf9af8c5c0e}{Matvec\+::local\+\_\+matvec}} (double $\ast$const out\+\_\+vec, double $\ast$const in\+\_\+vec, const Complex $\ast$const d\+\_\+mat\+\_\+freq, const unsigned int size, const unsigned int num\+\_\+cols, const unsigned int num\+\_\+rows, const bool conjugate, const bool unpad, const unsigned int device, cufft\+Handle forward\+\_\+plan, cufft\+Handle inverse\+\_\+plan, double $\ast$const out\+\_\+vec\+\_\+pad, Complex $\ast$const in\+\_\+vec\+\_\+freq, Complex $\ast$const out\+\_\+vec\+\_\+freq\+\_\+tosi, Complex $\ast$const in\+\_\+vec\+\_\+freq\+\_\+tosi, Complex $\ast$const out\+\_\+vec\+\_\+freq, cuda\+Stream\+\_\+t s, cublas\+Handle\+\_\+t cublas\+Handle)
\begin{DoxyCompactList}\small\item\em Perform local matrix-\/vector multiplication. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{matvec_8hpp_a1a73c2b528fe5b4b2ec3fd4de4765659}{Matvec\+::compute\+\_\+matvec}} (double $\ast$out\+\_\+vec, double $\ast$in\+\_\+vec, Complex $\ast$mat\+\_\+freq\+\_\+tosi, const unsigned int block\+\_\+size, const unsigned int num\+\_\+cols, const unsigned int num\+\_\+rows, const bool conjugate, const bool full, const unsigned int device, nccl\+Comm\+\_\+t nccl\+\_\+row\+\_\+comm, nccl\+Comm\+\_\+t nccl\+\_\+col\+\_\+comm, cuda\+Stream\+\_\+t s, double $\ast$const in\+\_\+vec\+\_\+pad, cufft\+Handle forward\+\_\+plan, cufft\+Handle inverse\+\_\+plan, cufft\+Handle forward\+\_\+plan\+\_\+conj, cufft\+Handle inverse\+\_\+plan\+\_\+conj, double $\ast$const out\+\_\+vec\+\_\+pad, Complex $\ast$const in\+\_\+vec\+\_\+freq, Complex $\ast$const out\+\_\+vec\+\_\+freq\+\_\+tosi, Complex $\ast$const in\+\_\+vec\+\_\+freq\+\_\+tosi, Complex $\ast$const out\+\_\+vec\+\_\+freq, cublas\+Handle\+\_\+t cublas\+Handle, Complex $\ast$mat\+\_\+freq\+\_\+tosi\+\_\+other, double $\ast$const res\+\_\+pad)
\begin{DoxyCompactList}\small\item\em Perform matrix-\/vector multiplication. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Header file for the Matvec namespace. 

This file contains the declarations of functions and variables related to the Matvec namespace. The Matvec namespace provides functions for matrix-\/vector operations. 

\doxysubsection{Function Documentation}
\mbox{\Hypertarget{matvec_8hpp_a1a73c2b528fe5b4b2ec3fd4de4765659}\label{matvec_8hpp_a1a73c2b528fe5b4b2ec3fd4de4765659}} 
\index{matvec.hpp@{matvec.hpp}!compute\_matvec@{compute\_matvec}}
\index{compute\_matvec@{compute\_matvec}!matvec.hpp@{matvec.hpp}}
\doxysubsubsection{\texorpdfstring{compute\_matvec()}{compute\_matvec()}}
{\footnotesize\ttfamily void Matvec\+::compute\+\_\+matvec (\begin{DoxyParamCaption}\item[{double $\ast$}]{out\+\_\+vec,  }\item[{double $\ast$}]{in\+\_\+vec,  }\item[{Complex $\ast$}]{mat\+\_\+freq\+\_\+tosi,  }\item[{const unsigned int}]{block\+\_\+size,  }\item[{const unsigned int}]{num\+\_\+cols,  }\item[{const unsigned int}]{num\+\_\+rows,  }\item[{const bool}]{conjugate,  }\item[{const bool}]{full,  }\item[{const unsigned int}]{device,  }\item[{nccl\+Comm\+\_\+t}]{nccl\+\_\+row\+\_\+comm,  }\item[{nccl\+Comm\+\_\+t}]{nccl\+\_\+col\+\_\+comm,  }\item[{cuda\+Stream\+\_\+t}]{s,  }\item[{double $\ast$const}]{in\+\_\+vec\+\_\+pad,  }\item[{cufft\+Handle}]{forward\+\_\+plan,  }\item[{cufft\+Handle}]{inverse\+\_\+plan,  }\item[{cufft\+Handle}]{forward\+\_\+plan\+\_\+conj,  }\item[{cufft\+Handle}]{inverse\+\_\+plan\+\_\+conj,  }\item[{double $\ast$const}]{out\+\_\+vec\+\_\+pad,  }\item[{Complex $\ast$const}]{in\+\_\+vec\+\_\+freq,  }\item[{Complex $\ast$const}]{out\+\_\+vec\+\_\+freq\+\_\+tosi,  }\item[{Complex $\ast$const}]{in\+\_\+vec\+\_\+freq\+\_\+tosi,  }\item[{Complex $\ast$const}]{out\+\_\+vec\+\_\+freq,  }\item[{cublas\+Handle\+\_\+t}]{cublas\+Handle,  }\item[{Complex $\ast$}]{mat\+\_\+freq\+\_\+tosi\+\_\+other,  }\item[{double $\ast$const}]{res\+\_\+pad }\end{DoxyParamCaption})}



Perform matrix-\/vector multiplication. 

This function performs matrix-\/vector multiplication using the provided matrix and vectors.


\begin{DoxyParams}{Parameters}
{\em out\+\_\+vec} & Pointer to the output vector. \\
\hline
{\em in\+\_\+vec} & Pointer to the input vector. \\
\hline
{\em mat\+\_\+freq\+\_\+tosi} & Pointer to the matrix in frequency domain (transpose of input, scaled). \\
\hline
{\em block\+\_\+size} & The block size for matrix operations. \\
\hline
{\em num\+\_\+cols} & The number of columns in the matrix. \\
\hline
{\em num\+\_\+rows} & The number of rows in the matrix. \\
\hline
{\em conjugate} & Flag indicating whether to perform conjugate multiplication. \\
\hline
{\em full} & Flag indicating whether to perform full matrix-\/vector multiplication. \\
\hline
{\em device} & The device ID. \\
\hline
{\em scale} & The scaling factor. \\
\hline
{\em nccl\+\_\+row\+\_\+comm} & The NCCL communicator for row-\/wise communication. \\
\hline
{\em nccl\+\_\+col\+\_\+comm} & The NCCL communicator for column-\/wise communication. \\
\hline
{\em s} & The CUDA stream. \\
\hline
{\em in\+\_\+vec\+\_\+pad} & Pointer to the padded input vector. \\
\hline
{\em forward\+\_\+plan} & The forward FFT plan. \\
\hline
{\em inverse\+\_\+plan} & The inverse FFT plan. \\
\hline
{\em forward\+\_\+plan\+\_\+conj} & The forward FFT plan for conjugate multiplication. \\
\hline
{\em inverse\+\_\+plan\+\_\+conj} & The inverse FFT plan for conjugate multiplication. \\
\hline
{\em out\+\_\+vec\+\_\+pad} & Pointer to the padded output vector. \\
\hline
{\em in\+\_\+vec\+\_\+freq} & Pointer to the input vector in frequency domain. \\
\hline
{\em out\+\_\+vec\+\_\+freq\+\_\+tosi} & Pointer to the output vector in frequency domain (transpose of input, scaled). \\
\hline
{\em in\+\_\+vec\+\_\+freq\+\_\+tosi} & Pointer to the input vector in frequency domain (transpose of input, scaled). \\
\hline
{\em out\+\_\+vec\+\_\+freq} & Pointer to the output vector in frequency domain. \\
\hline
{\em cublas\+Handle} & The handle for the cu\+BLAS library. \\
\hline
{\em mat\+\_\+freq\+\_\+tosi\+\_\+other} & Pointer to the matrix in frequency domain (transpose of input, scaled) on other devices. \\
\hline
{\em res\+\_\+pad} & Pointer to the padded result vector. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{matvec_8hpp_a88ade5f11b1bb8dff52f6cf9af8c5c0e}\label{matvec_8hpp_a88ade5f11b1bb8dff52f6cf9af8c5c0e}} 
\index{matvec.hpp@{matvec.hpp}!local\_matvec@{local\_matvec}}
\index{local\_matvec@{local\_matvec}!matvec.hpp@{matvec.hpp}}
\doxysubsubsection{\texorpdfstring{local\_matvec()}{local\_matvec()}}
{\footnotesize\ttfamily void Matvec\+::local\+\_\+matvec (\begin{DoxyParamCaption}\item[{double $\ast$const}]{out\+\_\+vec,  }\item[{double $\ast$const}]{in\+\_\+vec,  }\item[{const Complex $\ast$const}]{d\+\_\+mat\+\_\+freq,  }\item[{const unsigned int}]{size,  }\item[{const unsigned int}]{num\+\_\+cols,  }\item[{const unsigned int}]{num\+\_\+rows,  }\item[{const bool}]{conjugate,  }\item[{const bool}]{unpad,  }\item[{const unsigned int}]{device,  }\item[{cufft\+Handle}]{forward\+\_\+plan,  }\item[{cufft\+Handle}]{inverse\+\_\+plan,  }\item[{double $\ast$const}]{out\+\_\+vec\+\_\+pad,  }\item[{Complex $\ast$const}]{in\+\_\+vec\+\_\+freq,  }\item[{Complex $\ast$const}]{out\+\_\+vec\+\_\+freq\+\_\+tosi,  }\item[{Complex $\ast$const}]{in\+\_\+vec\+\_\+freq\+\_\+tosi,  }\item[{Complex $\ast$const}]{out\+\_\+vec\+\_\+freq,  }\item[{cuda\+Stream\+\_\+t}]{s,  }\item[{cublas\+Handle\+\_\+t}]{cublas\+Handle }\end{DoxyParamCaption})}



Perform local matrix-\/vector multiplication. 

This function performs local matrix-\/vector multiplication using the provided matrix and vectors.


\begin{DoxyParams}{Parameters}
{\em out\+\_\+vec} & Pointer to the output vector. \\
\hline
{\em in\+\_\+vec} & Pointer to the input vector. \\
\hline
{\em d\+\_\+mat\+\_\+freq} & Pointer to the matrix in device memory. \\
\hline
{\em size} & The size of the vectors. \\
\hline
{\em num\+\_\+cols} & The number of columns in the matrix. \\
\hline
{\em num\+\_\+rows} & The number of rows in the matrix. \\
\hline
{\em conjugate} & Flag indicating whether to perform conjugate multiplication. \\
\hline
{\em unpad} & Flag indicating whether to unpad the output vector. \\
\hline
{\em device} & The device ID. \\
\hline
{\em forward\+\_\+plan} & The forward FFT plan. \\
\hline
{\em inverse\+\_\+plan} & The inverse FFT plan. \\
\hline
{\em out\+\_\+vec\+\_\+pad} & Pointer to the padded output vector. \\
\hline
{\em in\+\_\+vec\+\_\+freq} & Pointer to the input vector in frequency domain. \\
\hline
{\em out\+\_\+vec\+\_\+freq\+\_\+tosi} & Pointer to the output vector in frequency domain (transpose of input, scaled). \\
\hline
{\em in\+\_\+vec\+\_\+freq\+\_\+tosi} & Pointer to the input vector in frequency domain (transpose of input, scaled). \\
\hline
{\em out\+\_\+vec\+\_\+freq} & Pointer to the output vector in frequency domain. \\
\hline
{\em s} & The CUDA stream. \\
\hline
{\em cublas\+Handle} & The handle for the cu\+BLAS library. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{matvec_8hpp_aabe780dd505d3c74bda0cead3705d835}\label{matvec_8hpp_aabe780dd505d3c74bda0cead3705d835}} 
\index{matvec.hpp@{matvec.hpp}!setup@{setup}}
\index{setup@{setup}!matvec.hpp@{matvec.hpp}}
\doxysubsubsection{\texorpdfstring{setup()}{setup()}}
{\footnotesize\ttfamily void Matvec\+::setup (\begin{DoxyParamCaption}\item[{Complex $\ast$$\ast$}]{d\+\_\+mat\+\_\+freq,  }\item[{const double $\ast$const}]{h\+\_\+mat,  }\item[{const unsigned int}]{block\+\_\+size,  }\item[{const unsigned int}]{num\+\_\+cols,  }\item[{const unsigned int}]{num\+\_\+rows,  }\item[{cublas\+Handle\+\_\+t}]{cublas\+Handle }\end{DoxyParamCaption})}



Set up the matrix and perform necessary initialization. 

This function sets up the matrix and performs necessary initialization for matrix-\/vector operations.


\begin{DoxyParams}{Parameters}
{\em d\+\_\+mat\+\_\+freq} & Pointer to the matrix in device memory. \\
\hline
{\em h\+\_\+mat} & Pointer to the matrix in host memory. \\
\hline
{\em block\+\_\+size} & The block size for matrix operations. \\
\hline
{\em num\+\_\+cols} & The number of columns in the matrix. \\
\hline
{\em num\+\_\+rows} & The number of rows in the matrix. \\
\hline
{\em cublas\+Handle} & The handle for the cu\+BLAS library. \\
\hline
\end{DoxyParams}
