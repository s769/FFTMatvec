\hypertarget{shared_8hpp}{}\doxysection{/home/srvenkat/matvec-\/test/src/shared.hpp File Reference}
\label{shared_8hpp}\index{/home/srvenkat/matvec-\/test/src/shared.hpp@{/home/srvenkat/matvec-\/test/src/shared.hpp}}


Header file containing shared definitions and includes.  


{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$iostream$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$cufft.\+h$>$}\newline
{\ttfamily \#include $<$cuda\+\_\+runtime.\+h$>$}\newline
{\ttfamily \#include $<$assert.\+h$>$}\newline
{\ttfamily \#include $<$time.\+h$>$}\newline
{\ttfamily \#include $<$sys/time.\+h$>$}\newline
{\ttfamily \#include $<$omp.\+h$>$}\newline
{\ttfamily \#include $<$cublas\+\_\+v2.\+h$>$}\newline
{\ttfamily \#include $<$string$>$}\newline
{\ttfamily \#include $<$vector$>$}\newline
{\ttfamily \#include $<$mpi.\+h$>$}\newline
{\ttfamily \#include $<$unistd.\+h$>$}\newline
{\ttfamily \#include $<$nccl.\+h$>$}\newline
{\ttfamily \#include \char`\"{}profiler.\+hpp\char`\"{}}\newline
{\ttfamily \#include $<$array$>$}\newline
\doxysubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{classenum__array}{enum\+\_\+array$<$ E, T, N $>$}}
\end{DoxyCompactItemize}
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{shared_8hpp_aa8bad2cd89820cdaf2a7f26392774014}\label{shared_8hpp_aa8bad2cd89820cdaf2a7f26392774014}} 
\#define {\bfseries MAX\+\_\+\+BLOCK\+\_\+\+SIZE}~1024
\item 
\mbox{\Hypertarget{shared_8hpp_a4fb3693f0d01012c45b1b583634709a8}\label{shared_8hpp_a4fb3693f0d01012c45b1b583634709a8}} 
\#define {\bfseries TIME\+\_\+\+MPI}~1
\item 
\mbox{\Hypertarget{shared_8hpp_acae7d8a730938629234fe04aa92f00da}\label{shared_8hpp_acae7d8a730938629234fe04aa92f00da}} 
\#define {\bfseries ERR\+\_\+\+CHK}~1
\item 
\mbox{\Hypertarget{shared_8hpp_a79f76929f121fd09ed7d2218ccac1e4c}\label{shared_8hpp_a79f76929f121fd09ed7d2218ccac1e4c}} 
\#define {\bfseries FFT\+\_\+64}~0
\item 
\mbox{\Hypertarget{shared_8hpp_a44db3a1c7355b88ed84d84d06c0f6898}\label{shared_8hpp_a44db3a1c7355b88ed84d84d06c0f6898}} 
\#define {\bfseries ROW\+\_\+\+SETUP}~1
\item 
\#define \mbox{\hyperlink{shared_8hpp_a3f6ea8e9ef58125936d50d7e1181aa7a}{gpu\+Errchk}}(ans)
\item 
\mbox{\Hypertarget{shared_8hpp_ac8d6afa75e39732a7f1e335796a45d69}\label{shared_8hpp_ac8d6afa75e39732a7f1e335796a45d69}} 
\#define {\bfseries cufft\+Safe\+Call}(err)~\mbox{\hyperlink{shared_8hpp_a9f29c08b4c05df300c03b9df807d2a92}{\+\_\+\+\_\+cufft\+Safe\+Call}}(err, \+\_\+\+\_\+\+FILE\+\_\+\+\_\+, \+\_\+\+\_\+\+LINE\+\_\+\+\_\+)
\item 
\mbox{\Hypertarget{shared_8hpp_a54e1ec1ec88fc39365f082189cae90b8}\label{shared_8hpp_a54e1ec1ec88fc39365f082189cae90b8}} 
\#define {\bfseries cublas\+Safe\+Call}(err)~\mbox{\hyperlink{shared_8hpp_ad998523e45dea448da1346e035dabdac}{\+\_\+\+\_\+cublas\+Safe\+Call}}(err, \+\_\+\+\_\+\+FILE\+\_\+\+\_\+, \+\_\+\+\_\+\+LINE\+\_\+\+\_\+)
\item 
\#define \mbox{\hyperlink{shared_8hpp_a788dc5a587af46da3f3779520bd150c7}{MPICHECK}}(cmd)
\item 
\#define \mbox{\hyperlink{shared_8hpp_afc86459c07f88390b299bb3d3f009522}{NCCLCHECK}}(cmd)
\end{DoxyCompactItemize}
\doxysubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{shared_8hpp_a342bfdb13d8be60c06abc23cbbdf8543}\label{shared_8hpp_a342bfdb13d8be60c06abc23cbbdf8543}} 
typedef int {\bfseries fft\+\_\+int\+\_\+t}
\item 
\mbox{\Hypertarget{shared_8hpp_a432dd191d396f7959476a7136c90e8c3}\label{shared_8hpp_a432dd191d396f7959476a7136c90e8c3}} 
typedef double2 {\bfseries Complex}
\item 
\mbox{\Hypertarget{shared_8hpp_a8c12a54b0b4d0fc75970cf4abdc7bf94}\label{shared_8hpp_a8c12a54b0b4d0fc75970cf4abdc7bf94}} 
typedef Complex {\bfseries data\+\_\+t}
\end{DoxyCompactItemize}
\doxysubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{shared_8hpp_a1a73356b3e712f82fe592eb927ccc19b}\label{shared_8hpp_a1a73356b3e712f82fe592eb927ccc19b}} 
enum class {\bfseries Profiler\+Times\+Full} \+: unsigned int \{ {\bfseries COMM\+\_\+\+INIT} = 0
, {\bfseries SETUP}
, {\bfseries FULL}
 \}
\item 
\mbox{\Hypertarget{shared_8hpp_a4f2fbb2cf8ddfe56c0ece954a96614aa}\label{shared_8hpp_a4f2fbb2cf8ddfe56c0ece954a96614aa}} 
enum class {\bfseries Profiler\+Times} \+: unsigned int \{ \newline
{\bfseries BROADCAST} = 0
, {\bfseries PAD}
, {\bfseries FFT}
, {\bfseries TRANS1}
, \newline
{\bfseries SBGEMV}
, {\bfseries TRANS2}
, {\bfseries IFFT}
, {\bfseries UNPAD}
, \newline
{\bfseries NCCLC}
, {\bfseries TOT}
 \}
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{shared_8hpp_ab3e90881a2476fd461eb2bcfcaa7cf63}{gpu\+Assert}} (cuda\+Error\+\_\+t code, const char $\ast$file, int line, bool abort=true)
\begin{DoxyCompactList}\small\item\em Checks the CUDA error code and prints an error message if an error occurred. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{shared_8hpp_a9f29c08b4c05df300c03b9df807d2a92}{\+\_\+\+\_\+cufft\+Safe\+Call}} (cufft\+Result err, const char $\ast$file, const int line)
\begin{DoxyCompactList}\small\item\em Safely calls the cufft function and checks for errors. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{shared_8hpp_ad998523e45dea448da1346e035dabdac}{\+\_\+\+\_\+cublas\+Safe\+Call}} (cublas\+Status\+\_\+t err, const char $\ast$file, const int line)
\begin{DoxyCompactList}\small\item\em Safely calls the cu\+BLAS function and checks for errors. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{shared_8hpp_a1dffdf385a230abb160cf514e289e2f1}\label{shared_8hpp_a1dffdf385a230abb160cf514e289e2f1}} 
\mbox{\hyperlink{classenum__array}{enum\+\_\+array}}$<$ Profiler\+Times\+Full, \mbox{\hyperlink{classprofiler__t}{profiler\+\_\+t}}, 3 $>$ {\bfseries t\+\_\+list}
\item 
\mbox{\Hypertarget{shared_8hpp_afc25d9fca3843968bdb05693e03171c5}\label{shared_8hpp_afc25d9fca3843968bdb05693e03171c5}} 
\mbox{\hyperlink{classenum__array}{enum\+\_\+array}}$<$ Profiler\+Times, \mbox{\hyperlink{classprofiler__t}{profiler\+\_\+t}}, 10 $>$ {\bfseries t\+\_\+list\+\_\+f}
\item 
\mbox{\Hypertarget{shared_8hpp_a38cf13bfa099cf1f95b8d4d282e98689}\label{shared_8hpp_a38cf13bfa099cf1f95b8d4d282e98689}} 
\mbox{\hyperlink{classenum__array}{enum\+\_\+array}}$<$ Profiler\+Times, \mbox{\hyperlink{classprofiler__t}{profiler\+\_\+t}}, 10 $>$ {\bfseries t\+\_\+list\+\_\+fs}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Header file containing shared definitions and includes. 

This file contains various definitions and includes that are commonly used across multiple source files. It includes standard C and C++ libraries, CUDA libraries, Open\+MP, MPI, NCCL, and other necessary headers. It also defines various constants, types, and helper functions for error checking.

\begin{DoxyNote}{Note}
This file should be included in all source files that require these shared definitions and includes. 
\end{DoxyNote}


\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{shared_8hpp_a3f6ea8e9ef58125936d50d7e1181aa7a}\label{shared_8hpp_a3f6ea8e9ef58125936d50d7e1181aa7a}} 
\index{shared.hpp@{shared.hpp}!gpuErrchk@{gpuErrchk}}
\index{gpuErrchk@{gpuErrchk}!shared.hpp@{shared.hpp}}
\doxysubsubsection{\texorpdfstring{gpuErrchk}{gpuErrchk}}
{\footnotesize\ttfamily \#define gpu\+Errchk(\begin{DoxyParamCaption}\item[{}]{ans }\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{\ \ \ \ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ gpuAssert((ans),\ \_\_FILE\_\_,\ \_\_LINE\_\_);\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \}}

\end{DoxyCode}
\mbox{\Hypertarget{shared_8hpp_a788dc5a587af46da3f3779520bd150c7}\label{shared_8hpp_a788dc5a587af46da3f3779520bd150c7}} 
\index{shared.hpp@{shared.hpp}!MPICHECK@{MPICHECK}}
\index{MPICHECK@{MPICHECK}!shared.hpp@{shared.hpp}}
\doxysubsubsection{\texorpdfstring{MPICHECK}{MPICHECK}}
{\footnotesize\ttfamily \#define MPICHECK(\begin{DoxyParamCaption}\item[{}]{cmd }\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{do}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ e\ =\ cmd;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ if\ (e\ !=\ MPI\_SUCCESS)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}Failed:\ MPI\ error\ \%s:\%d\ '\%d'\(\backslash\)n"{}},\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_FILE\_\_,\ \_\_LINE\_\_,\ e);\ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ exit(EXIT\_FAILURE);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \}\ \textcolor{keywordflow}{while}\ (0)}

\end{DoxyCode}
\mbox{\Hypertarget{shared_8hpp_afc86459c07f88390b299bb3d3f009522}\label{shared_8hpp_afc86459c07f88390b299bb3d3f009522}} 
\index{shared.hpp@{shared.hpp}!NCCLCHECK@{NCCLCHECK}}
\index{NCCLCHECK@{NCCLCHECK}!shared.hpp@{shared.hpp}}
\doxysubsubsection{\texorpdfstring{NCCLCHECK}{NCCLCHECK}}
{\footnotesize\ttfamily \#define NCCLCHECK(\begin{DoxyParamCaption}\item[{}]{cmd }\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{do}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ ncclResult\_t\ r\ =\ cmd;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ if\ (r\ !=\ ncclSuccess)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}Failed,\ NCCL\ error\ \%s:\%d\ '\%s'\(\backslash\)n"{}},\ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_FILE\_\_,\ \_\_LINE\_\_,\ ncclGetErrorString(r));\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ exit(EXIT\_FAILURE);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \}\ \textcolor{keywordflow}{while}\ (0)}

\end{DoxyCode}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{shared_8hpp_ad998523e45dea448da1346e035dabdac}\label{shared_8hpp_ad998523e45dea448da1346e035dabdac}} 
\index{shared.hpp@{shared.hpp}!\_\_cublasSafeCall@{\_\_cublasSafeCall}}
\index{\_\_cublasSafeCall@{\_\_cublasSafeCall}!shared.hpp@{shared.hpp}}
\doxysubsubsection{\texorpdfstring{\_\_cublasSafeCall()}{\_\_cublasSafeCall()}}
{\footnotesize\ttfamily void \+\_\+\+\_\+cublas\+Safe\+Call (\begin{DoxyParamCaption}\item[{cublas\+Status\+\_\+t}]{err,  }\item[{const char $\ast$}]{file,  }\item[{const int}]{line }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Safely calls the cu\+BLAS function and checks for errors. 


\begin{DoxyParams}{Parameters}
{\em err} & The cu\+BLAS status code. \\
\hline
{\em file} & The file path where the function is called. \\
\hline
{\em line} & The line number where the function is called. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{shared_8hpp_a9f29c08b4c05df300c03b9df807d2a92}\label{shared_8hpp_a9f29c08b4c05df300c03b9df807d2a92}} 
\index{shared.hpp@{shared.hpp}!\_\_cufftSafeCall@{\_\_cufftSafeCall}}
\index{\_\_cufftSafeCall@{\_\_cufftSafeCall}!shared.hpp@{shared.hpp}}
\doxysubsubsection{\texorpdfstring{\_\_cufftSafeCall()}{\_\_cufftSafeCall()}}
{\footnotesize\ttfamily void \+\_\+\+\_\+cufft\+Safe\+Call (\begin{DoxyParamCaption}\item[{cufft\+Result}]{err,  }\item[{const char $\ast$}]{file,  }\item[{const int}]{line }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Safely calls the cufft function and checks for errors. 


\begin{DoxyParams}{Parameters}
{\em err} & The cufft\+Result error code. \\
\hline
{\em file} & The file path where the function is called. \\
\hline
{\em line} & The line number where the function is called. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{shared_8hpp_ab3e90881a2476fd461eb2bcfcaa7cf63}\label{shared_8hpp_ab3e90881a2476fd461eb2bcfcaa7cf63}} 
\index{shared.hpp@{shared.hpp}!gpuAssert@{gpuAssert}}
\index{gpuAssert@{gpuAssert}!shared.hpp@{shared.hpp}}
\doxysubsubsection{\texorpdfstring{gpuAssert()}{gpuAssert()}}
{\footnotesize\ttfamily void gpu\+Assert (\begin{DoxyParamCaption}\item[{cuda\+Error\+\_\+t}]{code,  }\item[{const char $\ast$}]{file,  }\item[{int}]{line,  }\item[{bool}]{abort = {\ttfamily true} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Checks the CUDA error code and prints an error message if an error occurred. 


\begin{DoxyParams}{Parameters}
{\em code} & The CUDA error code to check. \\
\hline
{\em file} & The name of the file where the error occurred. \\
\hline
{\em line} & The line number where the error occurred. \\
\hline
{\em abort} & Flag indicating whether to abort the program if an error occurred (default\+: true). \\
\hline
\end{DoxyParams}
